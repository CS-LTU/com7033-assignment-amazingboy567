<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Patient Dataset</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #849eb7;
      margin: 0;
      padding: 20px;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    h1 {
      font-size: 26px;
      color: #333;
    }

    .logout-link {
      text-decoration: none;
      color: #f44336;
      font-weight: bold;
    }

    .stats {
      background: #ffffff;
      padding: 20px;
      border-radius: 8px;
      display: flex;
      gap: 20px;
      margin-bottom: 20px;

    }

    .stat {
      flex: 1;
      text-align: center;
      padding: 10px;
      background-color: #f0f3f7;
      border-radius: 6px;
    }

    .stat h3 {
      margin: 0;
      color: #555;
    }

    .stat p {
      font-size: 24px;
      margin-top: 5px;
      color: #111;
    }

    .search-bar {
      margin-bottom: 15px;
    }

    input[type="text"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #ffffff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    th, td { /* table headers and tables data cells */
      padding: 13px;
      border: 1px solid #e1e1e1;
      text-align: left;
    }

    th {
      background-color: #f0f3f7;
    }

    tr:hover { /* table row hover effect */
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>

  <header>
    <h1>Patient Dataset</h1>
    <a href="{{ url_for('logout') }}" class="logout-link">Logout</a>
  </header>

<!--Stats Section--> 
  <div class="stats"> 
    <div class="stat">
      <h3>Total Patients</h3>
      <p>{{ patients|length }}</p>
    </div>
    <div class="stat">
      <h3>Average Age</h3>
      <p>
        {{
          (patients|map(attribute='age')|sum) // (patients|length)
          if patients|length > 0 else 'N/A'
        }}
      </p>
    </div>
    <div class="stat">
      <h3>Smokers</h3>
      <p>
        {{
          patients|selectattr("smoking_status", "equalto", "smokes")|list|length
        }}
      </p>
    </div>
  </div>

  <!-- Search -->
  <div class="search-bar">
    <input type="text" id="searchInput" onkeyup="filterTable()" placeholder="Search patients by name, gender, or ID...">
  </div>

  <!-- Patient Table -->
  <table id="patientTable">
    <thead>
      <tr>
        {% for key in patients[0].keys() %}
          <th>{{ key|capitalize }}</th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% for patient in patients %}
        <tr>
          {% for value in patient.values() %}
            <td>{{ value }}</td>
          {% endfor %}
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <script>
    function filterTable() {
      const input = document.getElementById("searchInput").value.toLowerCase();
      const rows = document.querySelectorAll("#patientTable tbody tr");

      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(input) ? "" : "none";
      });
    }
  </script>

</body>
</html>

